@using WebMatrix.Data

@{
    // Check for session
    if (Session["id_user"] == null)
    {
        Response.Redirect("~/Login.cshtml");
    }

    // Fetch all classes
    List<Class> classes = Class.GetClasses();

    // Participate on class
    if (Request.QueryString["classid"] != null)
    {
        int classId = Request.QueryString["classid"].AsInt();
        if (classId != 0)
        {
            // Participate on class
            Class.ParticipateOnClass(classId, Convert.ToInt32(Session["id_user"]));
            Response.Redirect("~/Classes");
        }
    }
}

@RenderPage("~/Layout/Header.cshtml")

<div class="container">
	<div class="row">
		<div class="col-sm-1"></div>
		<div class="col-sm-10">
		    <h1>Classes</h1>
		    <div id="demo">
					<!-- For correct display on small screens you must add 'data-title' to each 'td' in your table -->
				<div class="table-responsive-vertical shadow-z-1">
					<!-- Table starts here -->
					<table id="table" class="table table-hover table-mc-light-blue">
					    <thead>
					    <tr>
							<th>Class</th>
							<th>Teacher</th>
							<th>Participate</th>
					    </tr>
					    </thead>
					    <tbody>
                            @foreach (Class item in classes)
                            {
                                User teacher = item.GetTeacher();
                                string fullname = teacher.GetFullName();
                                if (fullname == " ")
                                {
                                    fullname = "-";
                                }
                                var var2 = item;
                                var var1 = fullname;
                                <tr>
                                    <td data-title="Name">@item.GetClassname()</td>
                                    <td data-title="Link"> @fullname</td>
                                    <td data-title="Test"><a href="~/Classes?classid=@item.GetClassId()">Participate</a></td>
                                </tr>
                            }
					       
					    </tbody>
					</table>
					</div>
  
		    </div>
		</div>
		<div class="col-sm-1"></div>
	</div>
</div>

@RenderPage("~/Layout/Footer.cshtml");